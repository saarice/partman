{"error":{"code":"42P01","file":"parse_relation.c","length":106,"line":"1392","name":"error","position":"129","routine":"parserOpenTable","severity":"ERROR"},"level":"error","message":"Query error","service":"partnership-api","text":"\n      SELECT\n        type,\n        priority,\n        COUNT(*) as count,\n        MAX(created_at) as most_recent_date\n      FROM alerts\n      WHERE user_id = $1 AND is_acknowledged = false\n      GROUP BY type, priority\n      ORDER BY priority DESC, count DESC\n    ","timestamp":"2025-09-15T07:31:31.337Z"}
{"code":"42P01","file":"parse_relation.c","length":106,"level":"error","line":"1392","message":"Error fetching dashboard KPIs relation \"alerts\" does not exist","name":"error","position":"129","routine":"parserOpenTable","service":"partnership-api","severity":"ERROR","stack":"error: relation \"alerts\" does not exist\n    at /Users/saar/Partman/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/saar/Partman/apps/api/src/utils/database.ts:19:17)\n    at async DashboardService.getAlertSummary (/Users/saar/Partman/apps/api/src/services/dashboardService.ts:240:20)\n    at async Promise.all (index 4)\n    at async DashboardService.getKPIs (/Users/saar/Partman/apps/api/src/services/dashboardService.ts:69:11)\n    at async <anonymous> (/Users/saar/Partman/apps/api/src/controllers/dashboardController.ts:17:16)","timestamp":"2025-09-15T07:31:31.341Z"}
{"error":"relation \"alerts\" does not exist","level":"error","message":"Error occurred","method":"GET","service":"partnership-api","stack":"error: relation \"alerts\" does not exist\n    at /Users/saar/Partman/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/saar/Partman/apps/api/src/utils/database.ts:19:17)\n    at async DashboardService.getAlertSummary (/Users/saar/Partman/apps/api/src/services/dashboardService.ts:240:20)\n    at async Promise.all (index 4)\n    at async DashboardService.getKPIs (/Users/saar/Partman/apps/api/src/services/dashboardService.ts:69:11)\n    at async <anonymous> (/Users/saar/Partman/apps/api/src/controllers/dashboardController.ts:17:16)","statusCode":500,"timestamp":"2025-09-15T07:31:31.342Z","url":"/api/dashboard/kpis"}
{"error":{"code":"42P01","file":"parse_relation.c","length":105,"line":"1392","name":"error","position":"191","routine":"parserOpenTable","severity":"ERROR"},"level":"error","message":"Query error","service":"partnership-api","text":"\n      SELECT\n        u.id,\n        u.first_name || ' ' || u.last_name as name,\n        COUNT(DISTINCT o.id) as active_opportunities,\n        COALESCE(SUM(o.value), 0) as revenue\n      FROM users u\n      LEFT JOIN opportunities o ON u.id = o.assigned_user_id\n        AND o.stage NOT IN ('closed_won', 'closed_lost')\n      WHERE u.role != 'vp'\n      GROUP BY u.id, u.first_name, u.last_name\n    ","timestamp":"2025-09-15T07:31:31.344Z"}
{"error":{"code":"42P01","file":"parse_relation.c","length":113,"line":"1392","name":"error","position":"160","routine":"parserOpenTable","severity":"ERROR"},"level":"error","message":"Query error","service":"partnership-api","text":"\n      SELECT\n        stage,\n        COUNT(*) as count,\n        SUM(value) as total_value,\n        SUM(value * probability / 100) as weighted_value\n      FROM opportunities\n      WHERE stage NOT IN ('closed_won', 'closed_lost')\n      GROUP BY stage\n    ","timestamp":"2025-09-15T07:31:31.345Z"}
{"error":{"code":"42P01","file":"parse_relation.c","length":108,"line":"1392","name":"error","position":"229","routine":"parserOpenTable","severity":"ERROR"},"level":"error","message":"Query error","service":"partnership-api","text":"\n      SELECT\n        p.id,\n        p.name,\n        p.relationship_health_score,\n        COUNT(o.id) as opportunity_count,\n        COALESCE(SUM(CASE WHEN o.stage = 'closed_won' THEN o.value ELSE 0 END), 0) as revenue\n      FROM partners p\n      LEFT JOIN opportunities o ON p.id = o.partner_id\n      GROUP BY p.id, p.name, p.relationship_health_score\n      ORDER BY revenue DESC\n      LIMIT 5\n    ","timestamp":"2025-09-15T07:31:31.346Z"}
{"error":{"code":"42P01","file":"parse_relation.c","length":113,"line":"1392","name":"error","position":"160","routine":"parserOpenTable","severity":"ERROR"},"level":"error","message":"Query error","service":"partnership-api","text":"\n      SELECT\n        stage,\n        COUNT(*) as count,\n        SUM(value) as total_value,\n        SUM(value * probability / 100) as weighted_value\n      FROM opportunities\n      WHERE stage NOT IN ('closed_won', 'closed_lost')\n      GROUP BY stage\n    ","timestamp":"2025-09-15T07:31:31.382Z"}
{"code":"42P01","file":"parse_relation.c","length":113,"level":"error","line":"1392","message":"Error fetching dashboard KPIs relation \"opportunities\" does not exist","name":"error","position":"160","routine":"parserOpenTable","service":"partnership-api","severity":"ERROR","stack":"error: relation \"opportunities\" does not exist\n    at /Users/saar/Partman/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/saar/Partman/apps/api/src/utils/database.ts:19:17)\n    at async DashboardService.getPipelineKPIs (/Users/saar/Partman/apps/api/src/services/dashboardService.ts:117:20)\n    at async Promise.all (index 1)\n    at async DashboardService.getKPIs (/Users/saar/Partman/apps/api/src/services/dashboardService.ts:69:11)\n    at async <anonymous> (/Users/saar/Partman/apps/api/src/controllers/dashboardController.ts:17:16)","timestamp":"2025-09-15T07:31:31.384Z"}
{"error":"relation \"opportunities\" does not exist","level":"error","message":"Error occurred","method":"GET","service":"partnership-api","stack":"error: relation \"opportunities\" does not exist\n    at /Users/saar/Partman/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/saar/Partman/apps/api/src/utils/database.ts:19:17)\n    at async DashboardService.getPipelineKPIs (/Users/saar/Partman/apps/api/src/services/dashboardService.ts:117:20)\n    at async Promise.all (index 1)\n    at async DashboardService.getKPIs (/Users/saar/Partman/apps/api/src/services/dashboardService.ts:69:11)\n    at async <anonymous> (/Users/saar/Partman/apps/api/src/controllers/dashboardController.ts:17:16)","statusCode":500,"timestamp":"2025-09-15T07:31:31.384Z","url":"/api/dashboard/kpis"}
{"error":{"code":"42P01","file":"parse_relation.c","length":106,"line":"1392","name":"error","position":"129","routine":"parserOpenTable","severity":"ERROR"},"level":"error","message":"Query error","service":"partnership-api","text":"\n      SELECT\n        type,\n        priority,\n        COUNT(*) as count,\n        MAX(created_at) as most_recent_date\n      FROM alerts\n      WHERE user_id = $1 AND is_acknowledged = false\n      GROUP BY type, priority\n      ORDER BY priority DESC, count DESC\n    ","timestamp":"2025-09-15T07:31:31.389Z"}
{"error":{"code":"42P01","file":"parse_relation.c","length":108,"line":"1392","name":"error","position":"229","routine":"parserOpenTable","severity":"ERROR"},"level":"error","message":"Query error","service":"partnership-api","text":"\n      SELECT\n        p.id,\n        p.name,\n        p.relationship_health_score,\n        COUNT(o.id) as opportunity_count,\n        COALESCE(SUM(CASE WHEN o.stage = 'closed_won' THEN o.value ELSE 0 END), 0) as revenue\n      FROM partners p\n      LEFT JOIN opportunities o ON p.id = o.partner_id\n      GROUP BY p.id, p.name, p.relationship_health_score\n      ORDER BY revenue DESC\n      LIMIT 5\n    ","timestamp":"2025-09-15T07:31:31.391Z"}
{"error":{"code":"42P01","file":"parse_relation.c","length":105,"line":"1392","name":"error","position":"191","routine":"parserOpenTable","severity":"ERROR"},"level":"error","message":"Query error","service":"partnership-api","text":"\n      SELECT\n        u.id,\n        u.first_name || ' ' || u.last_name as name,\n        COUNT(DISTINCT o.id) as active_opportunities,\n        COALESCE(SUM(o.value), 0) as revenue\n      FROM users u\n      LEFT JOIN opportunities o ON u.id = o.assigned_user_id\n        AND o.stage NOT IN ('closed_won', 'closed_lost')\n      WHERE u.role != 'vp'\n      GROUP BY u.id, u.first_name, u.last_name\n    ","timestamp":"2025-09-15T07:31:31.392Z"}
{"error":{"code":"42P01","file":"parse_relation.c","length":104,"line":"1392","name":"error","position":"22","routine":"parserOpenTable","severity":"ERROR"},"level":"error","message":"Query error","service":"partnership-api","text":"SELECT COUNT(*) FROM users","timestamp":"2025-09-15T07:53:31.707Z"}
{"code":"42P01","file":"parse_relation.c","length":104,"level":"error","line":"1392","message":"Error inserting sample data: relation \"users\" does not exist","name":"error","position":"22","routine":"parserOpenTable","service":"partnership-api","severity":"ERROR","stack":"error: relation \"users\" does not exist\n    at /Users/saar/Partman/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/saar/Partman/apps/api/src/utils/database.ts:19:17)\n    at async insertSampleData (/Users/saar/Partman/apps/api/src/utils/sampleData.ts:9:23)\n    at async Server.<anonymous> (/Users/saar/Partman/apps/api/src/server.ts:79:5)","timestamp":"2025-09-15T07:53:31.710Z"}
{"code":"42P01","file":"parse_relation.c","length":104,"level":"error","line":"1392","message":"Failed to insert sample data: relation \"users\" does not exist","name":"error","position":"22","routine":"parserOpenTable","service":"partnership-api","severity":"ERROR","stack":"error: relation \"users\" does not exist\n    at /Users/saar/Partman/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/saar/Partman/apps/api/src/utils/database.ts:19:17)\n    at async insertSampleData (/Users/saar/Partman/apps/api/src/utils/sampleData.ts:9:23)\n    at async Server.<anonymous> (/Users/saar/Partman/apps/api/src/server.ts:79:5)","timestamp":"2025-09-15T07:53:31.710Z"}
{"error":{"code":"42883","file":"parse_oper.c","hint":"No operator matches the given name and argument types. You might need to add explicit type casts.","length":197,"line":"647","name":"error","position":"428","routine":"op_error","severity":"ERROR"},"level":"error","message":"Query error","service":"partnership-api","text":"\n      SELECT\n        o.id,\n        o.title,\n        o.assigned_user_id,\n        o.stage,\n        o.updated_at,\n        EXTRACT(DAYS FROM (CURRENT_TIMESTAMP - o.updated_at)) as days_stagnant\n      FROM opportunities o\n      WHERE o.stage NOT IN ('closed_won', 'closed_lost')\n        AND o.updated_at < CURRENT_TIMESTAMP - INTERVAL '14 days'\n        AND NOT EXISTS (\n          SELECT 1 FROM alerts a\n          WHERE a.entity_id = o.id::text\n            AND a.type = 'opportunity'\n            AND a.title LIKE '%stagnant%'\n            AND a.created_at > CURRENT_TIMESTAMP - INTERVAL '7 days'\n        )\n    ","timestamp":"2025-09-15T07:58:26.738Z"}
{"code":"42883","file":"parse_oper.c","hint":"No operator matches the given name and argument types. You might need to add explicit type casts.","length":197,"level":"error","line":"647","message":"Error during alert generation: operator does not exist: uuid = text","name":"error","position":"428","routine":"op_error","service":"partnership-api","severity":"ERROR","stack":"error: operator does not exist: uuid = text\n    at /Users/saar/Partman/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/saar/Partman/apps/api/src/utils/database.ts:19:17)\n    at async AlertService.generateStagnationAlerts (/Users/saar/Partman/apps/api/src/services/alertService.ts:190:20)\n    at async AlertService.generateOpportunityAlerts (/Users/saar/Partman/apps/api/src/services/alertService.ts:160:5)\n    at async Promise.all (index 0)\n    at async AlertService.runAlertGeneration (/Users/saar/Partman/apps/api/src/services/alertService.ts:339:7)","timestamp":"2025-09-15T07:58:26.739Z"}
{"error":{"code":"42883","file":"parse_oper.c","hint":"No operator matches the given name and argument types. You might need to add explicit type casts.","length":197,"line":"647","name":"error","position":"399","routine":"op_error","severity":"ERROR"},"level":"error","message":"Query error","service":"partnership-api","text":"\n      SELECT\n        p.id,\n        p.name,\n        p.relationship_health_score,\n        p.updated_at,\n        EXTRACT(DAYS FROM (CURRENT_TIMESTAMP - p.updated_at)) as days_since_update\n      FROM partners p\n      WHERE p.relationship_health_score < 70\n        OR p.updated_at < CURRENT_TIMESTAMP - INTERVAL '30 days'\n      AND NOT EXISTS (\n        SELECT 1 FROM alerts a\n        WHERE a.entity_id = p.id::text\n          AND a.type = 'partner'\n          AND a.created_at > CURRENT_TIMESTAMP - INTERVAL '7 days'\n      )\n    ","timestamp":"2025-09-15T07:58:26.740Z"}
{"error":"Invalid or expired token","level":"error","message":"Error occurred","method":"GET","service":"partnership-api","stack":"Error: Invalid or expired token\n    at createError (/Users/saar/Partman/apps/api/src/middleware/errorHandler.ts:36:27)\n    at authenticate (/Users/saar/Partman/apps/api/src/middleware/authentication.ts:43:10)\n    at Layer.handle [as handle_request] (/Users/saar/Partman/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/saar/Partman/node_modules/express/lib/router/index.js:328:13)\n    at /Users/saar/Partman/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/Users/saar/Partman/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/saar/Partman/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/Users/saar/Partman/node_modules/express/lib/router/index.js:175:3)\n    at router (/Users/saar/Partman/node_modules/express/lib/router/index.js:47:12)\n    at Layer.handle [as handle_request] (/Users/saar/Partman/node_modules/express/lib/router/layer.js:95:5)","statusCode":401,"timestamp":"2025-09-15T08:03:46.750Z","url":"/api/alerts/stats"}
{"error":"Expected property name or '}' in JSON at position 1 (line 1 column 2)","level":"error","message":"Error occurred","method":"POST","service":"partnership-api","stack":"SyntaxError: Expected property name or '}' in JSON at position 1 (line 1 column 2)\n    at JSON.parse (<anonymous>)\n    at parse (/Users/saar/Partman/node_modules/body-parser/lib/types/json.js:92:19)\n    at /Users/saar/Partman/node_modules/body-parser/lib/read.js:128:18\n    at AsyncResource.runInAsyncScope (node:async_hooks:211:14)\n    at invokeCallback (/Users/saar/Partman/node_modules/raw-body/index.js:238:16)\n    at done (/Users/saar/Partman/node_modules/raw-body/index.js:227:7)\n    at IncomingMessage.onEnd (/Users/saar/Partman/node_modules/raw-body/index.js:287:7)\n    at IncomingMessage.emit (node:events:507:28)\n    at endReadableNT (node:internal/streams/readable:1696:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:90:21)","statusCode":400,"timestamp":"2025-09-15T08:19:58.223Z","url":"/api/auth/login"}
{"error":"Access token required","level":"error","message":"Error occurred","method":"GET","service":"partnership-api","stack":"Error: Access token required\n    at createError (/app/apps/api/src/middleware/errorHandler.ts:36:27)\n    at authenticate (/app/apps/api/src/middleware/authentication.ts:28:17)\n    at Layer.handle [as handle_request] (/app/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/app/node_modules/express/lib/router/index.js:328:13)\n    at /app/node_modules/express/lib/router/index.js:286:9\n    at Function.process_params (/app/node_modules/express/lib/router/index.js:346:12)\n    at next (/app/node_modules/express/lib/router/index.js:280:10)\n    at Function.handle (/app/node_modules/express/lib/router/index.js:175:3)\n    at router (/app/node_modules/express/lib/router/index.js:47:12)\n    at Layer.handle [as handle_request] (/app/node_modules/express/lib/router/layer.js:95:5)","statusCode":401,"timestamp":"2025-09-15T08:31:15.979Z","url":"/api/dashboard/overview"}
{"error":{"code":"ECONNREFUSED"},"level":"error","message":"Query error","service":"partnership-api","text":"SELECT COUNT(*) FROM users","timestamp":"2025-09-17T18:22:30.551Z"}
{"code":"ECONNREFUSED","level":"error","message":"Error inserting sample data:","service":"partnership-api","stack":"AggregateError [ECONNREFUSED]: \n    at /Users/saar/Partman/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/saar/Partman/apps/api/src/utils/database.ts:19:17)\n    at async insertSampleData (/Users/saar/Partman/apps/api/src/utils/sampleData.ts:9:23)\n    at async Server.<anonymous> (/Users/saar/Partman/apps/api/src/server.ts:83:5)","timestamp":"2025-09-17T18:22:30.552Z"}
{"code":"ECONNREFUSED","level":"error","message":"Failed to insert sample data:","service":"partnership-api","stack":"AggregateError [ECONNREFUSED]: \n    at /Users/saar/Partman/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/saar/Partman/apps/api/src/utils/database.ts:19:17)\n    at async insertSampleData (/Users/saar/Partman/apps/api/src/utils/sampleData.ts:9:23)\n    at async Server.<anonymous> (/Users/saar/Partman/apps/api/src/server.ts:83:5)","timestamp":"2025-09-17T18:22:30.552Z"}
{"error":{"code":"ECONNREFUSED"},"level":"error","message":"Query error","service":"partnership-api","text":"SELECT COUNT(*) FROM users","timestamp":"2025-09-18T11:12:10.448Z"}
{"code":"ECONNREFUSED","level":"error","message":"Error inserting sample data:","service":"partnership-api","stack":"AggregateError [ECONNREFUSED]: \n    at /Users/saar/Partman/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/saar/Partman/apps/api/src/utils/database.ts:19:17)\n    at async insertSampleData (/Users/saar/Partman/apps/api/src/utils/sampleData.ts:9:23)\n    at async Server.<anonymous> (/Users/saar/Partman/apps/api/src/server.ts:83:5)","timestamp":"2025-09-18T11:12:10.450Z"}
{"code":"ECONNREFUSED","level":"error","message":"Failed to insert sample data:","service":"partnership-api","stack":"AggregateError [ECONNREFUSED]: \n    at /Users/saar/Partman/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/saar/Partman/apps/api/src/utils/database.ts:19:17)\n    at async insertSampleData (/Users/saar/Partman/apps/api/src/utils/sampleData.ts:9:23)\n    at async Server.<anonymous> (/Users/saar/Partman/apps/api/src/server.ts:83:5)","timestamp":"2025-09-18T11:12:10.450Z"}
{"error":{"code":"ECONNREFUSED"},"level":"error","message":"Query error","service":"partnership-api","text":"SELECT COUNT(*) FROM users","timestamp":"2025-09-18T11:15:05.963Z"}
{"code":"ECONNREFUSED","level":"error","message":"Error inserting sample data:","service":"partnership-api","stack":"AggregateError [ECONNREFUSED]: \n    at /Users/saar/Partman/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/saar/Partman/apps/api/src/utils/database.ts:19:17)\n    at async insertSampleData (/Users/saar/Partman/apps/api/src/utils/sampleData.ts:9:23)\n    at async Server.<anonymous> (/Users/saar/Partman/apps/api/src/server.ts:83:5)","timestamp":"2025-09-18T11:15:05.965Z"}
{"code":"ECONNREFUSED","level":"error","message":"Failed to insert sample data:","service":"partnership-api","stack":"AggregateError [ECONNREFUSED]: \n    at /Users/saar/Partman/node_modules/pg-pool/index.js:45:11\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async query (/Users/saar/Partman/apps/api/src/utils/database.ts:19:17)\n    at async insertSampleData (/Users/saar/Partman/apps/api/src/utils/sampleData.ts:9:23)\n    at async Server.<anonymous> (/Users/saar/Partman/apps/api/src/server.ts:83:5)","timestamp":"2025-09-18T11:15:05.965Z"}
{"error":"Invalid credentials","level":"error","message":"Error occurred","method":"POST","service":"partnership-api","stack":"Error: Invalid credentials\n    at createError (/Users/saar/Partman/apps/api/src/middleware/errorHandler.ts:36:27)\n    at <anonymous> (/Users/saar/Partman/apps/api/src/routes/auth.ts:28:11)\n    at <anonymous> (/Users/saar/Partman/apps/api/src/middleware/errorHandler.ts:43:19)\n    at Layer.handle [as handle_request] (/Users/saar/Partman/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/saar/Partman/node_modules/express/lib/router/route.js:149:13)\n    at Route.dispatch (/Users/saar/Partman/node_modules/express/lib/router/route.js:119:3)\n    at Layer.handle [as handle_request] (/Users/saar/Partman/node_modules/express/lib/router/layer.js:95:5)\n    at /Users/saar/Partman/node_modules/express/lib/router/index.js:284:15\n    at Function.process_params (/Users/saar/Partman/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/saar/Partman/node_modules/express/lib/router/index.js:280:10)","statusCode":401,"timestamp":"2025-09-18T11:17:39.214Z","url":"/api/auth/login"}
