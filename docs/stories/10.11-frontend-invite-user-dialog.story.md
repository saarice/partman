# Story 10.11: Frontend Invite User Dialog

**Story ID**: 10.11
**Epic**: 10 - Authentication & Authorization Enhancement
**Status**: Ready for Development
**Priority**: P1 (High)
**Effort**: 5 Story Points

## Story
**As a** system owner
**I want** an "Invite User" button and dialog
**So that** I can invite team members from the UI

## Acceptance Criteria
1. Add "Invite User" button to User Management page (system_owner only)
2. Button opens Material-UI Dialog with form
3. Form fields: Email (required), Role dropdown (required)
4. Role options: system_owner, vp, sales_manager, sales_rep, viewer
5. Form validates email format
6. Submit calls POST /api/invitations endpoint
7. Success shows toast: "Invitation sent to {email}"
8. Error shows toast with error message
9. Dialog closes on success
10. Email field clears on close

## Technical Notes
**InviteUserDialog.tsx:**
```typescript
interface InviteUserDialogProps {
  open: boolean;
  onClose: () => void;
  onSuccess: () => void;
}

export const InviteUserDialog: React.FC<InviteUserDialogProps> = ({ open, onClose, onSuccess }) => {
  const [email, setEmail] = useState('');
  const [role, setRole] = useState<string>('viewer');
  const [loading, setLoading] = useState(false);

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setLoading(true);

    try {
      await api.post('/invitations', { email, role });
      toast.success(`Invitation sent to ${email}`);
      onSuccess();
      onClose();
    } catch (error) {
      toast.error(error.response?.data?.message || 'Failed to send invitation');
    } finally {
      setLoading(false);
    }
  };

  return (
    <Dialog open={open} onClose={onClose} maxWidth="sm" fullWidth>
      <DialogTitle>Invite User</DialogTitle>
      <form onSubmit={handleSubmit}>
        <DialogContent>
          <TextField
            label="Email"
            type="email"
            value={email}
            onChange={(e) => setEmail(e.target.value)}
            fullWidth
            required
            autoFocus
            margin="normal"
          />
          <FormControl fullWidth margin="normal">
            <InputLabel>Role</InputLabel>
            <Select value={role} onChange={(e) => setRole(e.target.value)} required>
              <MenuItem value="viewer">Viewer</MenuItem>
              <MenuItem value="sales_rep">Sales Representative</MenuItem>
              <MenuItem value="sales_manager">Sales Manager</MenuItem>
              <MenuItem value="vp">VP</MenuItem>
              <MenuItem value="system_owner">System Owner</MenuItem>
            </Select>
          </FormControl>
        </DialogContent>
        <DialogActions>
          <Button onClick={onClose}>Cancel</Button>
          <Button type="submit" variant="contained" disabled={loading}>
            {loading ? 'Sending...' : 'Send Invitation'}
          </Button>
        </DialogActions>
      </form>
    </Dialog>
  );
};
```

## Tasks
- [ ] Create InviteUserDialog component
- [ ] Add email and role form fields
- [ ] Add form validation (email format)
- [ ] Implement handleSubmit with POST /api/invitations
- [ ] Add loading state during API call
- [ ] Add success toast notification
- [ ] Add error toast notification
- [ ] Add "Invite User" button to User Management page
- [ ] Show button only for system_owner role
- [ ] Wire up dialog open/close state
- [ ] Clear form on dialog close
- [ ] Test all role options
- [ ] Add helper text for role selection
- [ ] Test mobile responsiveness

## Testing
- [ ] Invite User button visible to system_owner
- [ ] Button hidden from non-system_owner roles
- [ ] Dialog opens on button click
- [ ] Email validation works correctly
- [ ] All role options selectable
- [ ] Form submission calls API correctly
- [ ] Success toast displays with email
- [ ] Error toast displays on failure
- [ ] Dialog closes on success
- [ ] Form clears on close
- [ ] Loading state prevents double submission
- [ ] Works on mobile devices

## Definition of Done
- Dialog functional and styled
- Form validation working
- API integration complete
- Toast notifications working
- Mobile responsive

## Agent Model Used
[To be filled by dev agent]

## Dev Agent Record

### File List
- `apps/web/src/components/admin/InviteUserDialog.tsx`
- `apps/web/src/pages/UserManagementPage.tsx`

### Change Log
[To be filled during implementation]
